try  { import-module ActiveDirectory
[reflection.assembly]::loadwithpartialname("System.Windows.Forms") | Out-Null
$CSForm = New-Object System.Windows.Forms.Form
$CSForm.Size = '300, 200'
$CSForm.Text = 'Clear Folder'

$computerLabelBox = New-Object System.Windows.Forms.Label
$computerLabelBox.Location = '10,23'
$computerLabelBox.Size = '70,70'
$computerLabelBox.Text = '  Computer:'
$CSForm.Controls.Add($computerLabelBox)

$computerTextBox = New-Object System.Windows.Forms.TextBox
$computerTextBox.Location = '80,23'
$computerTextBox.Size = '150,23'
$computerTextBox.ReadOnly = $false
$CSForm.Controls.Add($computerTextBox)

$okButton = New-Object System.Windows.Forms.Button
$okButton.Text = 'Ok'
$okButton.Location = "23,100"
$okButton.Add_Click({

# Leave this line commented out To run in Virtual Lab/Enterprise environment 

if (Test-Connection $computerTextBox.Text -Quiet) {
$returnStatus.Text = "Ping Successful"
$returnStatus.Text = "Processing"
$Session = New-PSSession -ComputerName $computerTextBox.Text
Invoke-Command -Session $Session {(Remove-Item C:\Test.txt -Recurse -force -Confirm:$false)}
$returnStatus.Text = "Complete"
} else {  $returnStatus.Text = "Computer Offline" }


#To test code on your computer/Non-enterprise environment
#if (Test-Connection $computerTextBox.Text -Quiet) {
#$returnStatus.Text = "Ping Successful"
#$returnStatus.Text = "Processing"
#Invoke-Command {(Remove-Item C:\Test -Recurse -force -Confirm:$false)}
#$returnStatus.Text = "Complete"
#} else {  $returnStatus.Text = "Computer Offline" }

})
$CSForm.AcceptButton = $okButton
$CSForm.Controls.Add($okButton)

$contentcButton = New-Object System.Windows.Forms.Button
$contentcButton.Text = 'Clear'
$contentcButton.Location = "100,100"
$contentcButton.Add_Click({
$computerTextBox.Text = ""
$returnStatus.Text = "Ready"

})
$CSForm.Controls.Add($contentcButton)

$cancelButton = New-Object System.Windows.Forms.Button
$cancelButton.Text = 'Close'
$cancelButton.Location = "180,100"
$cancelButton.Add_Click({
$CSForm.Close()
})
$CSForm.Controls.Add($cancelButton)

$returnStatus = New-Object System.Windows.Forms.StatusBar
$returnStatus.Name = "StatusBar"
$returnStatus.Text = "Ready"
$CSForm.Controls.Add($returnStatus)


$CSForm.ShowDialog()
}


Catch
{
Remove-Variable * -ErrorAction SilentlyContinue; Remove-Module *;
$error.Clear(); 
[System.Windows.MessageBox]::Show('Error deleting powershell cache reopen powershell')
}
